(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-97f45484"],{3056:function(t,e,a){"use strict";a("5d23")},"5d23":function(t,e,a){},7088:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"item__row item__ac"},[a("h2",[t._v("Пользователи")]),a("v-btn",{staticClass:"mx-2",attrs:{small:"",fab:"",dark:"",color:"indigo"},on:{click:function(e){return t.chooseTypeFunction(1)}}},[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-plus ")])],1)],1),a("v-data-table",{attrs:{headers:t.headers,items:t.users,page:t.page,loading:t.loading,options:t.options,"server-items-length":t.totalPage},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.created_at",fn:function(e){var a=e.item;return[t._v(" "+t._s(t.formatDate(a.created_at))+" ")]}},{key:"item.updated_at",fn:function(e){var a=e.item;return[t._v(" "+t._s(t.formatDate(a.updated_at))+" ")]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,i=e.attrs;return[t.me&&"admin"==t.me.role.role?a("i",t._g(t._b({staticClass:"mdi mdi-pencil",on:{click:function(e){return t.openEditModal(s)}}},"i",i,!1),o)):t._e()]}}],null,!0)},[a("span",[t._v("Редактировать")])]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,i=e.attrs;return[t.me&&"admin"==t.me.role.role?a("i",t._g(t._b({staticClass:"mdi mdi-trash-can-outline",on:{click:function(e){return t.openDeleteModal(s)}}},"i",i,!1),o)):t._e()]}}],null,!0)},[a("span",[t._v("Удалить")])])]}}])}),a("v-dialog",{attrs:{width:"500"},model:{value:t.destroyModal,callback:function(e){t.destroyModal=e},expression:"destroyModal"}},[a("v-card",{staticClass:"pa-6"},[a("h3",{staticClass:"mb-4"},[t._v("Удалить запись")]),a("v-btn",{attrs:{type:"submit",depressed:"",color:"primary"},on:{click:function(e){return t.deleteItem()}}},[t._v(" Да ")]),a("v-btn",{attrs:{type:"submit",depressed:"",color:"default"},on:{click:function(e){t.destroyModal=!1}}},[t._v(" Отмена ")])],1)],1),a("v-dialog",{attrs:{width:"500"},model:{value:t.newsModal,callback:function(e){t.newsModal=e},expression:"newsModal"}},[a("v-card",{staticClass:"pa-6"},[a("v-form",{ref:"form",staticClass:"sign__page__block",on:{submit:function(e){return e.preventDefault(),t.callFunction()}}},[1==t.type?a("h3",{staticClass:"mb-4"},[t._v("Создать пользователя")]):a("h3",{staticClass:"mb-4"},[t._v("Редактирование пользователя")]),a("div",{staticClass:"item__column"},[a("v-text-field",{staticClass:"input",attrs:{label:"ФИО",required:"",outlined:"",rules:t.nameRules},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),a("div",{staticClass:"item__column"},[a("v-text-field",{staticClass:"input",attrs:{label:"Email",required:"",outlined:"",rules:t.nameRules},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1),t.me&&"admin"==t.me.role.role?a("v-select",{staticClass:"mb-5",attrs:{items:t.roles,outlined:"","hide-details":!0,flat:!0,"item-text":"name_rus","item-value":"id","item-color":"#000",dense:"",required:""},model:{value:t.role,callback:function(e){t.role=e},expression:"role"}}):t._e(),1==t.type?a("div",{staticClass:"item__column"},[a("v-text-field",{staticClass:"input",attrs:{label:"Пароль",required:"",outlined:"",rules:t.nameRules},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1):a("div",{staticClass:"item__column"},[a("v-text-field",{staticClass:"input",attrs:{label:"Пароль",required:"",outlined:""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),a("v-btn",{attrs:{type:"submit",depressed:"",color:"primary"}},[t._v(" Отправить ")])],1)],1)],1)],1)},o=[],i=(a("ac1f"),a("1276"),a("d3b7"),a("159b"),a("b0c0"),a("a4d3"),a("e01a"),{name:"User",data:function(){return{user:null,headers:[{text:"№",align:"start",sortable:!1,value:"id"},{text:"ФИО",value:"name"},{text:"Email",value:"email"},{text:"Роль",value:"role.name_rus",sortable:!0},{text:"Дата создание",value:"created_at"},{text:"Дата редактирование",value:"updated_at"},{text:"Действие",value:"action"}],items:[],newsModal:!1,description:"",nameRules:[function(t){return!!t||"Заполните поле"}],descriptionRules:[function(t){return!!t||"Заполните поле"}],files:[],type:0,newsId:"",numberOfPages:null,totalPage:null,users:[],loading:!0,page:0,options:{itemsPerPage:5,page:1},me:[],name:null,email:null,password:null,destroyModal:!1,selectedUser:null,roles:[],role:null}},methods:{getProfile:function(){var t=this;this.$axios({method:"get",url:this.$API_URL+this.$API_VERSION+"me",headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}).then((function(e){t.user=e.data})).catch((function(t){console.warn(t)}))},getRoles:function(){var t=this;this.$axios({method:"get",url:this.$API_URL+this.$API_VERSION+"role",headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}).then((function(e){t.roles=e.data})).catch((function(t){console.warn(t)}))},formatDate:function(t){var e=t.split("T")[0].split("-"),a=t.split("T")[1].split(":");return e[2]+"-"+e[1]+"-"+e[0]+" "+a[0]+":"+a[1]},openEditModal:function(t){var e=this;this.roles.forEach((function(a){a.id==t.role.id&&(e.role=a)})),this.selectedUser=t,this.newsModal=!0,this.name=t.name,this.email=t.email},openDeleteModal:function(t){this.destroyModal=!0,this.selectedUser=t},getUser:function(){var t=this;this.$axios({method:"get",url:this.$API_URL+this.$API_VERSION+"me",headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}).then((function(e){t.me=e.data})).catch((function(t){console.warn(t)}))},fetch:function(){var t=this;this.loading=!0,this.$axios({method:"get",url:this.$API_URL+this.$API_VERSION+"user?per_page="+this.options.itemsPerPage+"&page="+this.options.page,headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}).then((function(e){t.loading=!1,t.numberOfPages=e.data.total,t.totalPage=e.data.total,t.users=e.data.data})).catch((function(t){console.warn(t)}))},chooseTypeFunction:function(t){this.type=t,this.newsModal=!0},callFunction:function(){1==this.type?this.create():this.update()},create:function(){var t=this;this.$axios.post(this.$API_URL+this.$API_VERSION+"user",{name:this.name,email:this.email,password:this.password},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}).then((function(e){console.log(e),t.$toast.open({message:e.data.message,type:"success",position:"bottom",duration:4e3,queue:!0}),t.newsModal=!1,t.type=0,t.fetch()})).catch((function(e){e.response&&422==e.response.status&&t.$toast.open({message:"Заполните все поля",type:"error",position:"bottom",duration:4e3,queue:!0})}))},show:function(t){var e=this;this.newsId=t,this.$axios({method:"get",url:this.$API_URL+this.$API_VERSION+"user/"+t,headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}).then((function(t){e.newsModal=!0,e.title=t.data.title,e.description=t.data.description})).catch((function(t){console.log(t)}))},deleteItem:function(){var t=this;this.$axios({method:"delete",url:this.$API_URL+this.$API_VERSION+"user/"+this.selectedUser.id,headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}).then((function(e){t.title=e.data.title,t.description=e.data.description,t.fetch()})).catch((function(t){console.log(t)}))},update:function(){var t=this;this.$axios.put(this.$API_URL+this.$API_VERSION+"user/"+this.selectedUser.id,{name:this.name,email:this.email,password:this.password,role:this.role},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}).then((function(e){t.$toast.open({message:e.data.message,type:"success",position:"bottom",duration:4e3,queue:!0}),t.newsModal=!1,t.fetch()})).catch((function(e){e.response&&422==e.response.status&&t.$toast.open({message:"Заполните все поля",type:"error",position:"bottom",duration:4e3,queue:!0})}))}},mounted:function(){this.getUser(),this.fetch(),this.getRoles()},beforeMount:function(){},watch:{options:{handler:function(t){t.itemsPerPage<0?(t.itemsPerPage=this.totalPage,this.fetch()):this.fetch()}},deep:!0}}),n=i,l=(a("3056"),a("2877")),r=a("6544"),c=a.n(r),u=a("8336"),d=a("b0af"),m=a("8fea"),h=a("169a"),p=a("4bd4"),f=a("132d"),_=a("b974"),v=a("8654"),g=a("3a2f"),b=Object(l["a"])(n,s,o,!1,null,null,null);e["default"]=b.exports;c()(b,{VBtn:u["a"],VCard:d["a"],VDataTable:m["a"],VDialog:h["a"],VForm:p["a"],VIcon:f["a"],VSelect:_["a"],VTextField:v["a"],VTooltip:g["a"]})}}]);
//# sourceMappingURL=chunk-97f45484.164e5e1e.js.map